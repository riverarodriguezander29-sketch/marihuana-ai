<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json">

    <title>Marihuana AI v13.0 - 2.5 Edition</title>
    <style> 
    
        :root { --g: #2ecc71; --bg: #050505; }
        body { background: var(--bg); color: white; font-family: 'Courier New', monospace; margin: 0; padding: 10px; display: flex; flex-direction: column; height: 98vh; }
        #chat { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 12px; padding: 15px; border: 1px solid #222; border-radius: 10px; background: #000; box-shadow: inset 0 0 10px #2ecc7122; }
        .m { padding: 12px; border-radius: 8px; max-width: 85%; font-size: 14px; line-height: 1.5; }
        .u { align-self: flex-end; background: rgba(46, 204, 113, 0.1); border: 1px solid var(--g); color: var(--g); }
        .a { align-self: flex-start; background: #111; border-left: 4px solid var(--g); white-space: pre-wrap; }
        #gui { margin-top: 10px; display: flex; gap: 8px; background: #000; padding: 5px; }
        input { flex: 1; background: #111; border: 1px solid #333; color: var(--g); padding: 12px; border-radius: 5px; outline: none; }
        button { background: var(--g); border: none; padding: 0 25px; border-radius: 5px; font-weight: bold; cursor: pointer; color: #000; }
        .status { font-size: 10px; color: #555; margin-bottom: 5px; letter-spacing: 2px; }
    </style>
</head>
<body>

    <div class="status">● MARIHUANA AI v13.0 | KERNEL: GEMINI-2.5-FLASH | ACTIVE</div>
    <div id="chat"></div>
    <div id="gui">
        <input type="text" id="p" placeholder="Escribe tu comando..." autocomplete="off">
        <button onclick="send()">RUN</button>
    </div>

<script>
    const KEY = "AIzaSyBQfPBnHhkr9NujZcw0VlUdMO1mz7K1zNE";
    
    // MODELO ACTUALIZADO SEGÚN TU LISTA
    const MODEL = "gemini-2.5-flash"; 

    const chat = document.getElementById('chat');
    const input = document.getElementById('p');

    function add(role, msg) {
        const d = document.createElement('div');
        d.className = `m ${role}`;
        d.innerText = msg;
        chat.appendChild(d);
        chat.scrollTop = chat.scrollHeight;
    }

    async function send() {
        const val = input.value.trim();
        if (!val) return;

        add('u', val);
        input.value = "";

        try {
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${KEY}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: val }] }]
                })
            });

            const data = await res.json();

            if (data.candidates && data.candidates[0].content) {
                add('a', data.candidates[0].content.parts[0].text);
            } else if (data.error) {
                add('a', "SISTEMA: " + data.error.message);
            }
        } catch (e) {
            add('a', "ERROR DE CONEXIÓN.");
        }
    }

    input.addEventListener("keypress", (e) => { if(e.key === 'Enter') send(); });
    
    add('a', "Sincronización exitosa con el núcleo Gemini 2.5 Flash. Sistema operativo al 100%. ¿Qué ejecutamos?");
</script>
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js');
  }
</script>
</body>
</html>
